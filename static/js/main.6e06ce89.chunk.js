(this["webpackJsonpreact-issue-ganttchart"]=this["webpackJsonpreact-issue-ganttchart"]||[]).push([[0],{134:function(e,t,n){},141:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){},240:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(14),u=n.n(a),i=n(77),s=n(17),o=(n(134),n(21)),l=n(118),c=n(22),d=n(5),p=n(272),f=n(279),g=n(241),h=n(278),b=n(109),m=n(280),v=n(112),_=n.n(v),j=n(12),k=n(110),y=n.n(k),O=n(7),w={multiselectContainer:{width:"27%",display:"inline-block",verticalAlign:"middle",padding:"4px",alignItems:"flex-end"},chips:{background:"light blue",fontSize:"15px"},searchBox:{border:"none"}},x=Object(d.a)((function(e){return{root:{"& > *":{fontSize:"13px",marginRight:"4px"}}}}))((function(e){var t=e.classes;return Object(O.jsxs)("form",{noValidate:!0,children:[Object(O.jsx)(p.a,{color:"primary",style:{verticalAlign:"middle"},children:Object(O.jsx)(y.a,{onClick:function(e){j.gantt.config.show_grid=!j.gantt.config.show_grid,j.gantt.render()}})}),Object(O.jsx)(f.a,{className:t.root,required:!0,placeholder:"https://github.com/lamact/react-issue-ganttchart",label:"Git Repository URL",style:{width:"20%",verticalAlign:"middle"},onChange:function(t){e.onGitURLChange(t.target.value)},inputRef:e.register,name:"git_url"}),Object(O.jsx)(f.a,{className:t.root,type:"password",placeholder:"Access Token",label:"Access Token",style:{width:"10%",verticalAlign:"middle"},onChange:function(t){e.onTokenChange(t.target.value)},inputRef:e.register,name:"token"}),Object(O.jsx)(b.Multiselect,{className:t.root,options:e.labels,selectedValues:e.selected_labels,onSelect:function(t){e.onSelectedLabelChange(t)},onRemove:function(t){e.onSelectedLabelChange(t)},displayValue:"name",style:w,placeholder:"filter by labels",hidePlaceholder:"false",emptyRecordMsg:"No Labels",closeIcon:"cancel"}),Object(O.jsx)(m.a,{className:t.root,size:"small",options:e.member_list,getOptionLabel:function(e){return e.name},value:e.selected_assignee,noOptionsText:"Requires a valid token",onChange:function(t,n){e.onSelectedAssigneeChange(n)},style:{width:"15%",verticalAlign:"middle",display:"inline-block",marginRight:"15px"},renderInput:function(e){return Object(O.jsx)(f.a,Object(c.a)(Object(c.a)({},e),{},{className:t.root,label:"Assignee",variant:"standard"}))}}),Object(O.jsxs)(h.a,{size:"small",style:{height:"34px"},children:[Object(O.jsx)(g.a,{onClick:function(t){e.onZoomChange("Weeks")},children:"Weeks"}),Object(O.jsx)(g.a,{onClick:function(t){e.onZoomChange("Days")},children:"Days"})]}),Object(O.jsx)(p.a,{color:"primary",style:{verticalAlign:"middle"},children:Object(O.jsx)(_.a,{onClick:function(){return window.open("https://github.com/lamact/react-issue-ganttchart")}})})]})})),D=(n(141),x),A=(n(142),n(113)),T=n.n(A),C=n(114),I=n.n(C),L=n(52),S=n.n(L),z=function(e){return null!==e&&e!==[]&&void 0!==e&&""!==e||!!Array.isArray(e)&&e.length>0},B=function(e){return z(e)&&"id"in e&&"name"in e},N=function(e){return!!z(e)&&/https?:\/\//.test(e)},R=function(e,t){return Math.round(e/t)*t},E=function(e,t){var n=S()(e,"YYYY/MM/DD");return S()(t,"YYYY/MM/DD").diff(n,"days")+1},P=function(e,t){var n=new Date(e),r=S()(n,"YYYY/MM/DD").add(t-1,"d").toDate();return M(r)},M=function(e){if("[object Date]"!==Object.prototype.toString.call(e))return null;if(isNaN(e.getFullYear()))return null;var t=e.toLocaleDateString("ja-JP");/\d{4}\/\d{1,2}\/\d{1,2}/.test(t)||(t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate());return t},Y=function(e){return M(new Date(e))},U=function(e,t,n){var r=null;return z(e)?r=M(e):z(n)&&(r=Y(n)),r},F=function(e,t,n){var r=null;return z(t)?r=new Date(t):z(n)&&(r=new Date(n)),r},G=function(e,t){return Y(null!=t?t:e)},$=function(e,t,n){return z(t)?(z(e)||(e=n),null!=e&&null!=t?E(e,t):1):null},J=function(e,t){if(!1 in t)return null;if(0===t.parent)return null;var n=e.getTask(t.parent).valueOf();n.start_date.getTime()>t.start_date.getTime()&&(n.start_date=t.start_date,e.updateTask(n.id,n),e.render()),n.end_date.getTime()<t.end_date.getTime()&&(n.end_date=t.end_date,e.updateTask(n.id,n),e.render())},Z=function(e,t,n){var r=e.getTask(n).valueOf(),a=r.duration.valueOf();r.start_date.getTime()<t.start_date.getTime()&&(r.start_date=t.start_date,r.end_date=new Date(P(t.start_date,a)),e.updateTask(r.id,r),e.render()),r.end_date.getTime()>t.end_date.getTime()&&(r.start_date=new Date(function(e,t){var n=new Date(e),r=S()(n,"YYYY/MM/DD").add(-t,"d").toDate();return M(r)}(t.end_date,a)),r.end_date=t.end_date,e.updateTask(r.id,r),e.render())},V={levels:[{name:"Days",scale_height:30,min_column_width:25,scales:[{unit:"month",step:1,format:"%n"},{unit:"day",step:1,format:"%d"}]},{name:"Weeks",scale_height:30,min_column_width:70,scales:[{unit:"week",step:1,format:"%n/%d~"}]}]},W=function(e){return"[object Date]"!==Object.prototype.toString.call(e)?null:("00"+(e.getMonth()+1)).slice(-2)+"/"+("00"+e.getDate()).slice(-2)},q=function(e){var t=Object(r.useRef)(null);return Object(r.useEffect)((function(){var n;(n=j.gantt).config.xml_date="%Y/%m/%d %H:%i",n.config.order_branch=!0,n.config.order_branch_free=!0,n.config.keep_grid_width=!0,n.config.grid_resize=!0,n.config.open_tree_initially=!0,n.config.fit_tasks=!0,n.config.show_grid=!1,n.config.sort=!0,n.config.columns=[{name:"id",label:"No.",align:"left",tree:!0,width:"120",template:function(e){var t=new Date;return t.setDate(t.getDate()-7),e.update<t.toLocaleDateString()?e.id+"<a title='There is no update for a week.'><span class='overdue'>i</span></a>":e.id}},{name:"start_date",label:"Start ",align:"center",width:"60",template:function(e){return W(e.start_date)}},{name:"due_date",label:"Due ",align:"center",width:"60",template:function(e){return W(e.due_date)}},{name:"assignee",label:"Assignee",align:"center",width:"130"},{name:"add",label:"",width:"30"}],n.plugins({quick_info:!0,drag_timeline:!0}),n.showDate(new Date),n.ext.zoom.init(V),function(e){e.templates.timeline_cell_class=function(e,t){if("[object Date]"!==Object.prototype.toString.call(t))return null;var n=new Date;if(t.getDate()===n.getDate()&&t.getMonth()===n.getMonth())return"today";if(0===t.getDay()||6===t.getDay())return"weekend";var r=new Date;return r.setDate(r.getDate()-1),t<r?"past_days":void 0},e.templates.task_text=function(e,t,n){return n.text},e.templates.task_class=function(e,t,n){if(1==n.progress)return"";if(n.progress<.01){if(e<=new Date)return"behind"}else if(new Date(P(e,(E(e,t)+1)*n.progress))<new Date)return"behind"}}(j.gantt),function(e,t){e.attachEvent("onTaskDblClick",(function(e,n){t.openIssueAtBrowser(e)})),e.attachEvent("onTaskCreated",(function(e,n){t.openNewIssueAtBrowser(e)})),e.attachEvent("onAfterTaskUpdate",(function(n,r){J(e,r),e.getChildren(r.id).map((function(t){Z(e,r,t)})),t.updateIssueByAPI(r,e)})),e.attachEvent("onBeforeTaskUpdate",(function(e,t,n){})),e.attachEvent("onAfterTaskMove",(function(n,r){var a=e.getTask(n);"parent"in a&&0!==a.parent&&(a.parent=r,t.updateIssueByAPI(a,e))})),e.attachEvent("onAfterLinkAdd",(function(t,n){var r=[],a=[],u=n.target;e.getTask(u).$target.forEach((function(t){var n=e.getLink(t),u=n.target,i=n.source;a.push({type:"0",target:u,source:i});var s=i.slice(1);""!=s&&r.push(s)})),e.getTask(u).dependon=r,e.getTask(u).links=a,e.updateTask(u)})),e.attachEvent("onAfterLinkDelete",(function(t,n){var r=[],a=[],u=n.target;e.getTask(u).$target.forEach((function(t){var n=e.getLink(t),u=n.target,i=n.source;a.push({type:"0",target:u,source:i});var s=i.slice(1);""!=s&&r.push(s)})),e.getTask(u).dependon=r,e.getTask(u).links=a,e.updateTask(u)})),e.attachEvent("onQuickInfo",(function(n){console.log("onQuickInfo");var r=e.getTask(n);e.locale.labels.detail_button="DETAIL",e.$click.buttons.detail_button=function(e){return t.openIssueAtBrowser(e),!0},e.ext.quickInfo.setContent({header:{title:"<h3>Description</h3>"},content:I.a.renderToStaticMarkup(Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{children:r.text}),Object(O.jsx)(T.a,{children:r.description})]})).toString(),buttons:["detail_button"]})})),e.attachEvent("onTaskDrag",(function(t,n,r,a){var u,i=e.getState(),s=i.min_date,o=i.max_date,l=e.date.add(new Date,i.scale_step,i.scale_unit)-new Date,c=!1;"resize"!=n&&"move"!=n||(Math.abs(r.start_date-s)<l?(u=r.start_date,c=!0):Math.abs(r.end_date-o)<l&&(u=r.end_date,c=!0),c&&(e.render(),e.showDate(u)))}))}(j.gantt,e),j.gantt.init(t.current),j.gantt.ext.zoom.setLevel(e.zoom)}),[]),Object(r.useEffect)((function(){"Days"===e.zoom?j.gantt.eachTask((function(e){e.$open=!0})):j.gantt.eachTask((function(e){e.$open=!1})),j.gantt.ext.zoom.setLevel(e.zoom)}),[e.zoom]),Object(r.useEffect)((function(){try{z(e.issue)&&0!=e.issue.length&&(j.gantt.clearAll(),e.issue.map((function(e){j.gantt.addTask(e),"links"in e&&e.links.map((function(e){return j.gantt.addLink(e),null}))})),j.gantt.sort("due_date",!1))}catch(t){j.gantt.message({text:t,type:"error"})}}),[e.issue]),Object(O.jsx)("div",{ref:t,style:{width:"100%",height:"100%"}})},H=(n(218),q),Q=n(115),K=function(e){return Object(O.jsxs)("div",{className:"application",children:[Object(O.jsxs)(Q.a,{children:[Object(O.jsx)("meta",{charSet:"utf-8"}),Object(O.jsx)("title",{children:e.title})]}),"..."]})},X=(n(219),K),ee=n(51),te=n(78),ne=function(e){return e.length>1&&/^#/.test(e)&&(e=e.substring(1)),e},re=function(e){return e.length>1&&/\/$/.test(e)&&(e=e.slice(0,-1)),e},ae=function(e){return e.length>1&&/ +$/.test(e)&&(e=e.slice(0,-1)),e},ue=function(e){if(null===e)return null;var t=function(e){if(null===e)return null;if("string"!==typeof e)return null;var t=e.split(/^```yaml/);return null===t||t.length<2||null===(t=t[1].split(/```/))||t.length<2?null:t[0]}(e);if(null===t)return null;var n=null;try{n=te.a.load(t)}catch(r){j.gantt.message({text:"failed load yaml"+t,type:"error"})}return n},ie=function(e,t){if(null===e)return null;var n=ue(e);if(null===n||!(t in n))return null;var r=n[t];return"number"!==typeof r?null:r},se=function(e,t){if(null===e)return null;var n=function(e,t){if(null===e)return null;var n=ue(e);if(null===n||!(t in n))return null;var r=n[t];return"string"!==typeof r?null:ae(ae(r))}(e,t);return/\d{4}\/\d{1,2}\/\d{1,2}/.test(n)?new Date(n):null},oe=function(e,t){if(null===e||null===t)return null;var n=te.a.dump(t);n="```yaml\n"+n+"```";var r=e.split(/^```yaml/);if(null===r||r.length<2)return/```/.test(e)?null:n+"\n"+e;var a=r[0];if(null===(r=r[1].split(/```/))||r.length<2)return null;var u=r[1];return null==a||null==u?null:a+n+u},le=function(e){var t="";return z(e)?(e.map((function(e){return B(e)&&z(e.id)&&(t+=e.id+":"+e.name+","),null})),t):null},ce=function(e){var t=[];if(z(e)){var n=e.split(",");n.forEach((function(e,r,a){if(r<n.length-1){var u=e.split(":");if(!isNaN(parseInt(u[0]))){var i={id:parseInt(u[0]),name:u[1]};t.push(i)}}}))}else t=[{id:0,name:""}];return t},de=function(e,t){if(null===e)return null;var n=ue(e);return null!==n&&t in n?n[t]:null},pe=n(8),fe=n(16),ge="https://api.github.com/repos/",he="https://github.com/",be=function(e){return!!N(e)&&(!(e.split("/").length<5)&&/github\.com/.test(e))},me=function(e){if(!be(e))return null;var t=e.split("/");return t.length>=5?t[3]:null},ve=function(e){if(!be(e))return null;var t=e.split("/");return t.length>=5?t[4]:null},_e=function(e,t){return be(e)&&z(t)?ge+me(e)+"/"+ve(e)+"/issues/"+t:null},je=function(e,t,n){if(!be(e)||!z(t)||!z(n))return null;var r="?";return r+="labels=",t.map((function(e){B(e)&&(r+=e.name+",")})),B(n)&&""!==n.name&&(r+="&assignee="+n.name),ge+me(e)+"/"+ve(e)+"/issues"+r},ke=function(e){return be(e)?ge+me(e)+"/"+ve(e)+"/labels":null},ye=function(e){return be(e)?ge+me(e)+"/"+ve(e)+"/collaborators":null},Oe=function(e,t){return be(e)&&z(t)?("number"===typeof(n=t)&&Number.isFinite(n)||(t=ne(t)),t<=0?null:he+me(e)+"/"+ve(e)+"/issues/"+t):null;var n},we=function(e){return!!N(e)&&(!(e.split("/").length<5)&&/gitlab\.com/.test(e))},xe=function(e){if(be(e))return null;if(!N(e))return null;var t=e.split("/");return t.length>=5?t[2]:null},De=function(e){if(!N(e))return null;var t=null,n=xe(e);return null!==n&&(t=e.substr(0,e.indexOf(":"))+"://"+n+"/"),t},Ae=function(e){return N(e)?De(e):null},Te=function(e){return N(e)?De(e)+"api/v4/":null},Ce=function(e){if(!N(e))return null;var t=(e=re(ae(e))).split("/");return 5==t.length?t[3]:t.length>=5?t.slice(3,t.length-1).join("%2F"):null},Ie=function(e){if(!N(e))return null;var t=(e=re(ae(e))).split("/");return 5==t.length?t[3]:t.length>=5?t.slice(3,t.length-1).join("/"):null},Le=function(e){if(!N(e))return null;var t=(e=re(ae(e))).split("/");return 5==t.length?t[4]:t.length>=5?t[t.length-1]:null},Se=function(e){var t="?";return z(e)&&"Tokens that have not yet been entered"!==e&&(t+="access_token="+e),t},ze=function(e,t,n,r){if(!N(e))return null;if(!z(t))return null;if(!z(n))return null;if(!B(r))return null;var a=Se(t);return z(n)&&(a+="&labels=",n.map((function(e){return B(e)&&(a+=e.name+","),null}))),B(r)&&""!==r.name&&(a+="&assignee_id="+r.id),a+="&per_page=100&state=opened",Te(e)+"projects/"+Ce(e)+"%2F"+Le(e)+"/issues"+a},Be=function(e,t,n){if(!N(e))return null;if(!z(t))return null;if(!z(n))return null;var r=Se(t);return Te(e)+"projects/"+Ce(e)+"%2F"+Le(e)+"/issues/"+n+r},Ne=function(e,t){if(!N(e))return null;var n=Se(t);return n+="&per_page=100",Te(e)+"projects/"+Ce(e)+"%2F"+Le(e)+"/labels"+n},Re=function(e,t){if(!N(e))return null;var n=Se(t);return Te(e)+"projects/"+Ce(e)+"%2F"+Le(e)+"/members/all"+n+"&per_page=200"},Ee=n(28),Pe=n.n(Ee),Me=function(e){return null!==e.assignee?e.assignee.login:""},Ye=function(e,t){var n=se(e,"start_date"),r=se(e,"due_date"),a={id:"#"+t.number,text:t.title,start_date:U(n,0,t.created_at),due_date:F(0,r,t.created_at),duration:$(n,r,t.created_at),progress:ie(e,"progress"),assignee:Me(t),parent:"#"+ie(e,"parent"),description:e,update:G(t.created_at,t.updated_at)},u=[],i=Ue(e,t);if("undefined"!=typeof i)for(var s=0;s<i.length;s++){var o={type:i[s].type,target:i[s].target,source:i[s].source};u.push(o)}return a.links=u,a},Ue=function(e,t){var n,r=[];if(n=de(e,"dependon"),z(n)){for(var a=0;a<n.length;a++){var u=[];u.type="0",u.target="#"+t.number,u.source="#"+n[a],r.push(u)}return r}},Fe=function(e,t){var n=Y(t.start_date).replace(/\-/g,"/"),r={start_date:n,due_date:P(n,t.duration).replace(/\-/g,"/"),progress:R(t.progress,.01)};return"parent"in t&&(r.parent=parseInt(ne(t.parent))),"dependon"in t&&(r.dependon=t.dependon),e=oe(e,r)},Ge=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n,r){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(_e(t,r.number),{headers:{Authorization:"Bearer ".concat(n)},data:{}}).then((function(e){return Ye(e.data.body,r)})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),$e=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n,r,a){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(je(t,r,a),{headers:{Authorization:"Bearer ".concat(n)},data:{}}).then((function(e){var r=[];return e.data.map((function(e){r.push(Ge(t,n,e))})),Promise.all(r)})).catch((function(e){return Promise.reject(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),Je=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(ke(t),{headers:{Authorization:"Bearer ".concat(n)},data:{}}).then((function(e){var t=[];return e.data.map((function(e){return t.push({id:e.id,name:e.name}),null})),t})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z(n)||"Tokens that have not yet been entered"===n){e.next=4;break}return e.abrupt("return",Pe.a.get(ye(t),{headers:{Authorization:"Bearer ".concat(n)},data:{}}).then((function(e){var t=[];return e.data.map((function(e){return t.push({id:e.id,name:e.login}),null})),t})));case 4:console.warn("token is not valid!");case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(e,t,n,r){var a=_e(r,ne(e.id));return Pe.a.get(a,{headers:{Authorization:"Bearer ".concat(t)},data:{}}).then((function(r){var u,i,s=r.data;null==Fe(s.body,e)?n.message({text:"failed update issue. "+e.text,type:"error"}):(u=function(e){var t=[];return e.links.map((function(e){var n=[];n.type=e.type,n.target=e.target,n.source=e.source,t.push(n)})),{id:e.id,text:e.text,start_date:Y(e.start_date),due_date:e.due_date,duration:e.duration,progress:e.progress,assignee:e.assignee,description:e.description,update:e.update,links:t,parent:"#"+e.parent}}(e),i=Ye(s.body,s),(u.id!=i.id||u.text!=i.text||u.start_date!=i.start_date||u.due_date!=i.due_date.toString()||u.duration!=i.duration||u.progress!=i.progress||u.assignee!=i.assignee||u.update!=i.update||u.parent!=i.parent||JSON.stringify(u.links)!=JSON.stringify(i.links))&&Pe.a.post(a,{body:Fe(s.body,e)},{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){n.message({text:"success update issue.  "+e.id})})).catch((function(e){n.message({text:"failed update GitHub issue. check your token."+e,type:"error"})})))})).catch((function(e){n.message({text:"failed get GitHub issue. check your url."+e,type:"error"}),$e(n,t,r)})),null},We=function(e,t){var n=M(new Date),r=M(new Date);null==e.parent&&(e.parent=0);var a={start_date:n,due_date:r,progress:.1,parent:parseInt(ne(e.parent))},u=oe("",a);u=encodeURIComponent(u),window.open(function(e){return be(e)?he+me(e)+"/"+ve(e)+"/issues/new?assignees=&labels=&title=&body=":null}(t)+u,"_blank")},qe=function(e){return z(e)&&"assignee"in e&&z(e.assignee)&&"name"in e.assignee?e.assignee.name:""},He=function(e){var t=se(e.description,"start_date"),n=Y(e.due_date),r={id:"#"+e.iid,text:e.title,start_date:U(t,0,e.created_at),due_date:F(0,n,e.created_at),duration:$(t,n,e.created_at),progress:ie(e.description,"progress"),assignee:qe(e),description:e.description,update:G(e.created_at,e.updated_at)},a=ie(e.description,"parent");null!==a&&0!==a&&(r.parent="#"+a);var u=[],i=Qe(e);if("undefined"!=typeof i)for(var s=0;s<i.length;s++){var o={type:i[s].type,target:i[s].target,source:i[s].source};u.push(o)}return r.links=u,r},Qe=function(e){var t,n=[];if(null!=(t=de(e.description,"dependon"))){for(var r=0;r<t.length;r++){var a=[];a.type="0",a.target="#"+e.iid,a.source="#"+t[r],n.push(a)}return n}},Ke=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n,r,a){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(ze(t,n,r,a)).then((function(e){var t=[];return e.data.map((function(e){var n=He(e);t.push(n)})),t})).catch((function(e){return console.error(e),Promise.reject(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),Xe=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(Ne(t,n)).then((function(e){var t=[];return e.data.map((function(e){return t.push(e),null})),t})).catch((function(e){return console.error(e),Promise.reject(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pe.a.get(Re(t,n)).then((function(e){var t=[];return e.data.map((function(e){return t.push({id:e.id,name:e.name}),null})),t})).catch((function(e){return console.error(e),Promise.reject(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),tt=function(e,t,n,r){return Pe.a.get(Be(r,t,ne(e.id))).then((function(a){var u,i,s=a.data;if(u=function(e){var t=[];e.links.map((function(e){t.push({type:e.type,target:e.target,source:e.source})}));var n={id:e.id,text:e.text,start_date:Y(e.start_date),due_date:e.due_date,duration:e.duration,progress:e.progress,assignee:e.assignee,description:e.description,update:e.update,links:t};return 0!==e.parent&&(n.parent=e.parent),n}(e),i=He(s),(u.id!=i.id||u.text!=i.text||u.start_date!=i.start_date||u.due_date!=i.due_date.toString()||u.duration!=i.duration||u.progress!=i.progress||u.assignee!=i.assignee||u.update!=i.update||u.parent!=i.parent||JSON.stringify(u.links)!=JSON.stringify(i.links))&&parseInt(s.iid)===parseInt(ne(e.id))){var o=function(e,t){var n={start_date:Y(t.start_date).replace(/\-/g,"/"),progress:R(t.progress,.01)};return"parent"in t&&(n.parent=parseInt(ne(t.parent))),"dependon"in t&&(n.dependon=t.dependon),oe(e,n)}(s.description,e);if(null!=o){o=encodeURIComponent(o);var l=Y(e.start_date),c=P(l,e.duration),d=Be(r,t,ne(e.id))+"&description="+o+"&due_date="+c;return Pe.a.put(d).then((function(t){n.message({text:"success update issue.  "+e.id})})).catch((function(e){return console.error(e),Promise.reject(e)}))}n.message({text:"failed update issue. "+e.text,type:"error"})}})).catch((function(e){n.message({text:"failed get GitLab issue. check your token.",type:"error"})}))},nt=function(e,t){window.open(function(e,t){return N(e)?Ae(e)+Ie(e)+"/"+Le(e)+"/-/issues/"+t:null}(t,ne(e)),"_blank")},rt=function(e,t){var n=M(new Date);null==e.parent&&(e.parent=0);var r={start_date:n,progress:.1,parent:parseInt(ne(e.parent))},a=oe("",r);a=encodeURIComponent(a),window.open(function(e){return N(e)?Ae(e)+Ie(e)+"/"+Le(e)+"/issues/new?issue[description]=":null}(t)+a,"_blank")},at=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n,r,a){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N(t)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(!be(t)){e.next=8;break}return e.abrupt("return",$e(t,n,r,a));case 8:if(!we(t)&&null===xe(t)){e.next=10;break}return e.abrupt("return",Ke(t,n,r,a));case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),ut=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N(t)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(!be(t)){e.next=8;break}return e.abrupt("return",Je(t,n));case 8:if(!we(t)&&null===xe(t)){e.next=10;break}return e.abrupt("return",Xe(t,n));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),it=function(){var e=Object(fe.a)(Object(pe.a)().mark((function e(t,n){return Object(pe.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N(t)){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:if(!be(t)){e.next=8;break}return e.abrupt("return",Ze(t,n));case 8:if(!we(t)&&null===xe(t)){e.next=10;break}return e.abrupt("return",et(t,n));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),st=function(e,t){if(!N(t))return Promise.resolve();be(t)?function(e,t){window.open(Oe(t,ne(e)),"_blank")}(e,t):(we(t)||null!==xe(t))&&nt(e,t)},ot={currentZoom:"Days",git_url:"",token:"Tokens that have not yet been entered",labels:[],selected_labels:[],member_list:[],selected_assignee:{},issue:[],issue_columns:[],title:""},lt=function(e,t){switch(t.type){case"zoomChange":return Object(c.a)(Object(c.a)({},e),{},{currentZoom:t.value});case"gitURLChange":return ft(e,t);case"tokenChange":return Object(c.a)(Object(c.a)({},e),{},{token:gt(t.value)});case"labelChange":return Object(c.a)(Object(c.a)({},e),{},{labels:t.value});case"selectedLabelsChange":return Object(c.a)(Object(c.a)({},e),{},{selected_labels:ht(t.value.props,e.git_url,t.value.selected_labels,e.selected_assignee)});case"memberListChange":return Object(c.a)(Object(c.a)({},e),{},{member_list:bt(t.value)});case"selectedAssigneeChange":return Object(c.a)(Object(c.a)({},e),{},{selected_assignee:mt(t.value.props,e.git_url,e.selected_labels,t.value.selected_assignee)});case"openIssueAtBrowser":return ct(e,t);case"openNewIssueAtBrowser":return dt(e,t);case"updateIssueByAPI":return pt(e,t);case"setIssue":return Object(c.a)(Object(c.a)({},e),{},{issue:t.value});case"setStateFromURLQueryString":return _t(e,t.value.props,t.value.setValue);default:return e}},ct=function(e,t){return st(t.value,e.git_url),e},dt=function(e,t){return function(e,t){if(!N(t))return null;be(t)?We(e,t):(we(t)||null!==xe(t))&&rt(e,t)}(t.value,e.git_url),e},pt=function(e,t){var n,r,a,u;return n=t.value.gantt_task,r=e.token,a=t.value.gantt,u=e.git_url,N(u)?be(u)?Ve(n,r,a,u):(we(u)||null!==xe(u))&&tt(n,r,a,u):Promise.resolve(),e},ft=function(e,t){var n=re(ae(t.value.git_url));if(be(n))j.gantt.message({text:"Access GitHub.com"}),e.title=ve(n);else if(we(n))j.gantt.message({text:"Access GitLab.com"}),e.title=Le(n);else if(null!==xe(n))j.gantt.message({text:"Access Maybe GitLab.self-host"}),e.title=Le(n);else if(""!==n)return j.gantt.message({text:"Not a valid URL.",type:"error"}),null;return vt(t.value.props,n,e.selected_labels,t.value.selected_assignee),e.git_url=n,e},gt=function(e){return Object(ee.bake_cookie)("git_token",e),e},ht=function(e,t,n,r){return vt(e,t,n,r),n},bt=function(e){return z(e)?e:[]},mt=function(e,t,n,r){return vt(e,t,n,r),r},vt=function(e,t,n,r){var a=new URLSearchParams(e.location.search);return a.set("giturl",t),a.set("labels",le(n)),a.set("assignee",le([r])),e.history.push({search:a.toString()}),null},_t=function(e,t,n){var r=new URLSearchParams(t.location.search);e.git_url=r.get("giturl");var a=re(ae(r.get("giturl")));be(a)?e.title=ve(a):(we(a)||null!==xe(a))&&(e.title=Le(a)),e.git_url=a;var u=ce(r.get("labels"));z(u[0])&&"name"in u[0]&&""!==u[0].name&&(e.selected_labels=u);var i=ce(r.get("assignee"));return z(i)&&(e.selected_assignee=i[0]),n("git_url",e.git_url),e},jt=Object(s.e)((function(e){var t=Object(r.useReducer)(lt,ot),n=Object(o.a)(t,2),a=n[0],u=n[1],i=Object(l.a)({git_url:"",token:""}),s=i.register,c=i.setValue;return Object(r.useEffect)((function(){c("token",Object(ee.read_cookie)("git_token")),u({type:"tokenChange",value:Object(ee.read_cookie)("git_token")})}),[]),Object(r.useEffect)((function(){u({type:"setStateFromURLQueryString",value:{props:e,setValue:c}})}),[e.location]),Object(r.useEffect)((function(){ut(a.git_url,a.token).then((function(e){u({type:"labelChange",value:e})})).catch((function(e){j.gantt.message({text:e,type:"error"})})),it(a.git_url,a.token).then((function(e){u({type:"memberListChange",value:e})})).catch((function(e){j.gantt.message({text:e,type:"error"})}))}),[a.git_url,a.token,a.selected_assignee]),Object(r.useEffect)((function(){at(a.git_url,a.token,a.selected_labels,a.selected_assignee).then((function(e){u({type:"setIssue",value:e})})).catch((function(e){console.log("error")}))}),[a.git_url,a.token,a.selected_labels,a.selected_assignee]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(X,{title:a.title}),Object(O.jsx)("div",{className:"zoom-bar",children:Object(O.jsx)(D,{zoom:a.currentZoom,onZoomChange:function(e){return u({type:"zoomChange",value:e})},onGitURLChange:function(t){return u({type:"gitURLChange",value:{props:e,git_url:t}})},token:a.token,onTokenChange:function(e){return u({type:"tokenChange",value:e})},labels:a.labels,selected_labels:a.selected_labels,onSelectedLabelChange:function(t){return u({type:"selectedLabelsChange",value:{props:e,selected_labels:t}})},member_list:a.member_list,selected_assignee:a.selected_assignee,onSelectedAssigneeChange:function(t){return u({type:"selectedAssigneeChange",value:{props:e,selected_assignee:t}})},register:s})}),Object(O.jsx)("div",{className:"gantt-container",children:Object(O.jsx)(H,{zoom:a.currentZoom,git_url:a.git_url,token:a.token,selected_labels:a.selected_labels,selected_assignee:a.selected_assignee,issue:a.issue,openIssueAtBrowser:function(e){return u({type:"openIssueAtBrowser",value:e})},openNewIssueAtBrowser:function(e){return u({type:"openNewIssueAtBrowser",value:e})},updateIssueByAPI:function(e,t){return u({type:"updateIssueByAPI",value:{gantt_task:e,gantt:t}})}})})]})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(Object(O.jsx)(i.a,{children:Object(O.jsx)(s.a,{render:function(e){return Object(O.jsx)(jt,{})}})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[240,1,2]]]);
//# sourceMappingURL=main.6e06ce89.chunk.js.map